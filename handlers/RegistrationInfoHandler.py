from .BaseHandler import BaseHandler
from telebot import types


class RegistrationInfoHandler(BaseHandler):
    def handle(self, message):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –º–µ–Ω—é —Å –≤—ã–±–æ—Ä–æ–º —Ç–∏–ø–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏."""
        self.show_registration_type_choice(message)

    def show_registration_type_choice(self, message):

        registration_markup = types.ReplyKeyboardMarkup(row_width=1, resize_keyboard=True, one_time_keyboard=True)
        registration_markup.add(
            types.KeyboardButton('–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –∫–≤–∞—Ä—Ç–∏—Ä—ã'),
            types.KeyboardButton('–î–µ—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ (–Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–µ)'),
            types.KeyboardButton('–î–µ—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ (–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 18 –ª–µ—Ç)'),
            types.KeyboardButton('–°—É–ø—Ä—É–≥(–∞) —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞'),
            types.KeyboardButton('–õ–∏—Ü–∞, –Ω–µ —è–≤–ª—è—é—â–∏–µ—Å—è —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏'),
            types.KeyboardButton('–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥')
        )
        self.bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:", reply_markup=registration_markup)
        self.bot.register_next_step_handler(message, self.registration_type)

    def registration_type(self, message):
        """–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–∞—Å–ø–æ—Ä—Ç–Ω–æ–º —Å—Ç–æ–ª–µ –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ –≤—ã–±–æ—Ä—É."""
        if message.text == '–°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –∫–≤–∞—Ä—Ç–∏—Ä—ã':
            self.send_owner_docs_info(message)
        elif message.text == '–î–µ—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ (–Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–µ)':
            self.send_owner_children_docs_info(message)
        elif message.text == '–î–µ—Ç–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ (–¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ 18 –ª–µ—Ç)':
            self.send_adult_children_docs_info(message)
        elif message.text == '–°—É–ø—Ä—É–≥(–∞) —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞':
            self.send_spouse_docs_info(message)
        elif message.text == '–õ–∏—Ü–∞, –Ω–µ —è–≤–ª—è—é—â–∏–µ—Å—è —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏':
            self.send_non_relative_docs_info(message)
        elif message.text == '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥':
            from .StartHandler import StartHandler
            StartHandler(self.bot).handle(message)
        else:
            self.handle_unknown(message, self.show_registration_type_choice)

    def send_owner_docs_info(self, message):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã."""
        response = (
            "üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã:*\n\n"
            "1Ô∏è‚É£ –ù–∞–ª–∏—á–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã.\n"
            "2Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞.\n"
            "3Ô∏è‚É£ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—É –∏–∑ –ë–¢–ò (–æ—Ä–∏–≥–∏–Ω–∞–ª).\n"
            "4Ô∏è‚É£ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã.\n"
            "5Ô∏è‚É£ –í–æ–µ–Ω–Ω—ã–π –±–∏–ª–µ—Ç —Å –æ—Ç–º–µ—Ç–∫–æ–π –æ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ –≤–æ–∏–Ω—Å–∫–∏–π —É—á–µ—Ç –ø–æ –Ω–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É (–¥–ª—è –≤–æ–µ–Ω–Ω–æ–æ–±—è–∑–∞–Ω–Ω—ã—Ö).\n\n"
            "üí≥ *–ü—É—Ç–∏ –æ–ø–ª–∞—Ç—ã –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:*\n"
            "üîπ –ï—Ä–∏–ø - –ú–í–î - –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ –∏ –º–∏–≥—Ä–∞—Ü–∏—è - –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω –ë–µ–ª–æ—Ä—É—Å–∏ - –≥. –ì–æ–º–µ–ª—å - –í—ã–±—Ä–∞—Ç—å —Ä–∞–π–æ–Ω - –†–µ–≥–∏—Å—Ç-—è –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞/–ø—Ä–µ–±—ã–≤–∞–Ω–∏—è.\n\n")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def send_owner_children_docs_info(self, message):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –¥–µ—Ç–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞."""
        response = (
            "üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –¥–µ—Ç–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞:*\n\n"
            "1Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª–µ–π.\n"
            "2Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç –∏ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ —Ä–µ–±–µ–Ω–∫–∞ (–æ—Ä–∏–≥–∏–Ω–∞–ª).\n"
            "    ‚ùóÔ∏è *–í–∞–∂–Ω–æ:* –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ø–æ –¥—Ä—É–≥–æ–º—É –∞–¥—Ä–µ—Å—É, "
            "–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Ä–µ–±–µ–Ω–∫–∞.\n"
            "3Ô∏è‚É£–°–æ–≥–ª–∞—Å–∏–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —É –ø–∞—Å–ø–æ—Ä—Ç–∏—Å—Ç–∞ –∏–ª–∏ –≤ –†–°–¶.")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def send_adult_children_docs_info(self, message):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –¥–µ—Ç–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞."""
        response = (
            "üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏—Ö –¥–µ—Ç–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞:*\n\n"
            "1Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç.\n"
            "2Ô∏è‚É£ –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ (–æ—Ä–∏–≥–∏–Ω–∞–ª).\n"
            "3Ô∏è‚É£ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã.\n"
            "4Ô∏è‚É£ –í–æ–µ–Ω–Ω—ã–π –±–∏–ª–µ—Ç —Å –æ—Ç–º–µ—Ç–∫–æ–π –æ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ –≤–æ–∏–Ω—Å–∫–∏–π —É—á–µ—Ç –ø–æ –Ω–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É (–¥–ª—è –≤–æ–µ–Ω–Ω–æ–æ–±—è–∑–∞–Ω–Ω—ã—Ö).\n\n"
            "üí≥ *–ü—É—Ç–∏ –æ–ø–ª–∞—Ç—ã –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:*\n"
            "üîπ –ï—Ä–∏–ø - –ú–í–î - –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ –∏ –º–∏–≥—Ä–∞—Ü–∏—è - –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω –ë–µ–ª–æ—Ä—É—Å–∏ - –≥. –ì–æ–º–µ–ª—å - –í—ã–±—Ä–∞—Ç—å —Ä–∞–π–æ–Ω - –†–µ–≥–∏—Å—Ç-—è –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞/–ø—Ä–µ–±—ã–≤–∞–Ω–∏—è.\n\n")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def send_spouse_docs_info(self, message):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—É–ø—Ä—É–≥–∞(–∏) —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞."""
        response = (
            "üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å—É–ø—Ä—É–≥–∞(–∏) —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞:*\n\n"
            "1Ô∏è‚É£ –ù–∞–ª–∏—á–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã.\n"
            "2Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç.\n"
            "3Ô∏è‚É£ –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ –±—Ä–∞–∫–µ (–æ—Ä–∏–≥–∏–Ω–∞–ª).\n"
            "4Ô∏è‚É£ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã.\n"
            "5Ô∏è‚É£ –í–æ–µ–Ω–Ω—ã–π –±–∏–ª–µ—Ç —Å –æ—Ç–º–µ—Ç–∫–æ–π –æ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ –≤–æ–∏–Ω—Å–∫–∏–π —É—á–µ—Ç –ø–æ –Ω–æ–≤–æ–º—É –∞–¥—Ä–µ—Å—É (–¥–ª—è –≤–æ–µ–Ω–Ω–æ–æ–±—è–∑–∞–Ω–Ω—ã—Ö).\n\n"
            "üí≥ *–ü—É—Ç–∏ –æ–ø–ª–∞—Ç—ã –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:*\n"
            "üîπ –ï—Ä–∏–ø - –ú–í–î - –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ –∏ –º–∏–≥—Ä–∞—Ü–∏—è - –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω –ë–µ–ª–æ—Ä—É—Å–∏ - –≥. –ì–æ–º–µ–ª—å - –í—ã–±—Ä–∞—Ç—å —Ä–∞–π–æ–Ω - –†–µ–≥–∏—Å—Ç-—è –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞/–ø—Ä–µ–±—ã–≤–∞–Ω–∏—è.\n\n")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def send_non_relative_docs_info(self, message):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ª–∏—Ü, –Ω–µ —è–≤–ª—è—é—â–∏—Ö—Å—è —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏."""
        response = (
            "üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ª–∏—Ü, –Ω–µ —è–≤–ª—è—é—â–∏—Ö—Å—è —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏:*\n\n"
            "1Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç.\n"
            "2Ô∏è‚É£ –î–æ–≥–æ–≤–æ—Ä –Ω–∞–π–º–∞ –∂–∏–ª–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è (–æ—Ä–∏–≥–∏–Ω–∞–ª).\n"
            "   ‚ùóÔ∏è *–í–∞–∂–Ω–æ:* –î–æ–≥–æ–≤–æ—Ä –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–π–æ–Ω–∞.\n"
            "Ô∏è4Ô∏è‚É£ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã.\n\n"
            "üí≥ *–ü—É—Ç–∏ –æ–ø–ª–∞—Ç—ã –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:*\n"
            "üîπ –ï—Ä–∏–ø - –ú–í–î - –ì—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ –∏ –º–∏–≥—Ä–∞—Ü–∏—è - –¥–ª—è –≥—Ä–∞–∂–¥–∞–Ω –ë–µ–ª–æ—Ä—É—Å–∏ - –≥. –ì–æ–º–µ–ª—å - –í—ã–±—Ä–∞—Ç—å —Ä–∞–π–æ–Ω - –†–µ–≥–∏—Å—Ç-—è –∂–∏—Ç–µ–ª—å—Å—Ç–≤–∞/–ø—Ä–µ–±—ã–≤–∞–Ω–∏—è.\n\n")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def show_final_choice(self, message):
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤—ã–±–æ—Ä–æ–º "–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é" –∏ "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥"
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
        markup.add(types.KeyboardButton('–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥'), types.KeyboardButton('–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é'))
        self.bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=markup)
        self.bot.register_next_step_handler(message, self.handle_final_choice)

    def handle_final_choice(self, message):
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        if message.text == '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥':
            self.show_registration_type_choice(message)
        elif message.text == '–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é':
            self.bot.send_message(message.chat.id, "–†–∞–¥—ã –±—ã–ª–∏ –ø–æ–º–æ—á—å! –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –µ—â—ë –≤–æ–ø—Ä–æ—Å—ã, –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.")
        else:
            self.handle_unknown(message, self.show_final_choice)