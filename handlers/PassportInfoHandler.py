from .BaseHandler import BaseHandler
from telebot import types


class PassportInfoHandler(BaseHandler):
    def handle(self, message):
        self.show_passport_type_choice(message)

    def show_passport_type_choice(self, message):
        # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ø–∞—Å–ø–æ—Ä—Ç–∞
        passport_markup = types.ReplyKeyboardMarkup(row_width=1, resize_keyboard=True, one_time_keyboard=True)
        passport_markup.add(
            types.KeyboardButton('–î–µ—Ç—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç'),
            types.KeyboardButton('–í–∑—Ä–æ—Å–ª—ã–π –ø–∞—Å–ø–æ—Ä—Ç'),
            types.KeyboardButton('–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥')
        )
        self.bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø–∞—Å–ø–æ—Ä—Ç–∞:", reply_markup=passport_markup)
        self.bot.register_next_step_handler(message, self.passport_type)

    def passport_type(self, message):
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if message.text == '–î–µ—Ç—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç':
            self.show_child_passport_info(message)
        elif message.text == '–í–∑—Ä–æ—Å–ª—ã–π –ø–∞—Å–ø–æ—Ä—Ç':
            self.show_adult_passport_info(message)
        elif message.text == '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥':
            from .StartHandler import StartHandler
            StartHandler(self.bot).handle(message)
        else:
            self.handle_unknown(message, self.show_passport_type_choice)

    def show_child_passport_info(self, message):
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è –¥–µ—Ç—Å–∫–æ–≥–æ –ø–∞—Å–ø–æ—Ä—Ç–∞
        response = ("üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–º–µ–Ω—ã –¥–µ—Ç—Å–∫–æ–≥–æ –ø–∞—Å–ø–æ—Ä—Ç–∞:*\n\n"
                    "üëâ *–ü–µ—Ä–≤–∏—á–Ω—ã–π –ø–∞—Å–ø–æ—Ä—Ç:*\n"
                    "1Ô∏è‚É£ –ß–µ—Ç—ã—Ä–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.\n"
                    "2Ô∏è‚É£ –û—Ä–∏–≥–∏–Ω–∞–ª —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏.\n"
                    "3Ô∏è‚É£ –ü–∞—Å–ø–æ—Ä—Ç –æ–¥–Ω–æ–≥–æ –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª–µ–π.\n"
                    "4Ô∏è‚É£ –ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ —Å—Ç–∞—Ä—à–µ 14 –ª–µ—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å –≥–æ—Å–ø–æ—à–ª–∏–Ω—É (–æ–ø–ª–∞—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∞ –ø–æ –º–µ—Å—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏).\n\n"
                    "üëâ *–ü—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–∞—Å–ø–æ—Ä—Ç–∞:*\n"
                    "1Ô∏è‚É£ –ß–µ—Ç—ã—Ä–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.\n"
                    "2Ô∏è‚É£ –ö–æ–ø–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏.\n"
                    "3Ô∏è‚É£ –ï—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ —Å—Ç–∞—Ä—à–µ 14 –ª–µ—Ç, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å –≥–æ—Å–ø–æ—à–ª–∏–Ω—É (–æ–ø–ª–∞—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Å—É—â–µ—Å—Ç–≤–ª–µ–Ω–∞ –ø–æ –º–µ—Å—Ç—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏).\n\n"
                    "üîç *–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:*\n"
                    "üî∏ –î–µ—Ç—è–º –¥–æ 14 –ª–µ—Ç –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Å–ø–æ—Ä—Ç–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ.\n"
                    "üî∏ –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–≥–æ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã –∑–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ. –î–æ—Å—Ç—É–ø–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ä–æ–∫–æ–≤ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è: 7 –∏ 15 –¥–Ω–µ–π.\n"
                    "üî∏ –ü–ª–∞—Ç–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ SMS-–æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–∞—Å–ø–æ—Ä—Ç–∞.")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def show_adult_passport_info(self, message):
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –¥–ª—è –≤–∑—Ä–æ—Å–ª–æ–≥–æ –ø–∞—Å–ø–æ—Ä—Ç–∞
        response = ("üìù *–î–æ–∫—É–º–µ–Ω—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–º–µ–Ω—ã –ø–∞—Å–ø–æ—Ä—Ç–∞ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö:*\n\n"
                    "1Ô∏è‚É£ –ß–µ—Ç—ã—Ä–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏, –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å –æ–±—Ä–∞—Ç–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.\n"
                    "2Ô∏è‚É£ –ö–æ–ø–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ –¥–µ—Ç–µ–π, –µ—Å–ª–∏ —Ä–µ–±–µ–Ω–æ–∫ –Ω–µ –¥–æ—Å—Ç–∏–≥ 16 –ª–µ—Ç.\n"
                    "3Ô∏è‚É£ –ö–æ–ø–∏—è —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–∞ –æ –±—Ä–∞–∫–µ –∏–ª–∏ —Ä–µ—à–µ–Ω–∏–µ —Å—É–¥–∞ –æ —Ä–∞–∑–≤–æ–¥–µ.\n"
                    "   ‚ùóÔ∏è *–í–∞–∂–Ω–æ:* –í —Å–ª—É—á–∞—è—Ö —Å–º–µ–Ω—ã —Ñ–∞–º–∏–ª–∏–∏ –∏–∑-–∑–∞ –±—Ä–∞–∫–∞ –∏–ª–∏ —Ä–∞–∑–≤–æ–¥–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π —Ñ–∞–º–∏–ª–∏–∏. –≠—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫:\n"
                    "      - –í–æ–∑–≤—Ä–∞—Ç—É –∫ –¥–µ–≤–∏—á—å–µ–π —Ñ–∞–º–∏–ª–∏–∏ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–æ–¥–∞.\n"
                    "      - –°–º–µ–Ω–µ —Ñ–∞–º–∏–ª–∏–∏ –ø–æ—Å–ª–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –±—Ä–∞–∫.\n"
                    "4Ô∏è‚É£ –ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã.\n\n"
                    "üîé *–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:*\n"
                    "üî∏ –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å–∫–æ—Ä–µ–Ω–Ω–æ–≥–æ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Ç–∞–∫–∂–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é –æ–± —É–ø–ª–∞—Ç–µ –≥–æ—Å–ø–æ—à–ª–∏–Ω—ã –∑–∞ —É—Å–∫–æ—Ä–µ–Ω–∏–µ. –î–æ—Å—Ç—É–ø–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å—Ä–æ–∫–æ–≤ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è: 7 –∏ 15 –¥–Ω–µ–π.\n"
                    "üî∏ –ü–ª–∞—Ç–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–æ SMS-–æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–∞—Å–ø–æ—Ä—Ç–∞.")
        self.bot.send_message(message.chat.id, response, parse_mode="Markdown")
        self.show_final_choice(message)

    def show_final_choice(self, message):
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –≤—ã–±–æ—Ä–æ–º "–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é" –∏ "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥"
        markup = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
        markup.add(types.KeyboardButton('–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥'), types.KeyboardButton('–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é'))
        self.bot.send_message(message.chat.id, "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=markup)
        self.bot.register_next_step_handler(message, self.handle_final_choice)

    def handle_final_choice(self, message):
        # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        if message.text == '–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥':
            self.show_passport_type_choice(message)
        elif message.text == '–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é':
            self.bot.send_message(message.chat.id, "–†–∞–¥—ã –±—ã–ª–∏ –ø–æ–º–æ—á—å! –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –µ—â—ë –≤–æ–ø—Ä–æ—Å—ã, –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.")
        else:
            self.handle_unknown(message, self.show_final_choice)
